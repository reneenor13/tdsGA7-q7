import pandas as pd
import matplotlib.pyplot as plt
from io import StringIO
import base64

# Email for verification
print("23f3003731@ds.study.iitm.ac.in")

# Sample dataset
data = """employee_id,department,region,performance_score,years_experience,satisfaction_rating
EMP001,IT,Europe,88.92,3,3.5
EMP002,Finance,Africa,71.95,1,4.9
EMP003,R&D,Africa,92.5,12,3.1
EMP004,IT,Middle East,79.05,8,4.8
EMP005,R&D,Europe,87.83,15,4.3
EMP006,IT,Europe,85.12,4,4.5
EMP007,Finance,Asia,73.45,6,3.9
EMP008,IT,Asia,81.33,7,4.1
EMP009,IT,Europe,90.21,10,4.7
EMP010,Finance,Europe,76.58,2,4.0
EMP011,IT,Asia,88.45,9,3.8
EMP012,R&D,Middle East,91.78,11,4.6
EMP013,Finance,Europe,79.65,3,4.2
EMP014,IT,Europe,82.33,6,3.9
EMP015,IT,Africa,77.95,5,4.4
"""

# Load DataFrame
df = pd.read_csv(StringIO(data))

# Count IT employees
it_count = df[df['department'] == 'IT'].shape[0]
count_text = f"Frequency count for IT department: {it_count}"
print(count_text)

# Create histogram
plt.figure(figsize=(8,5))
df['department'].value_counts().plot(kind='bar', color='skyblue')
plt.title('Department Distribution')
plt.xlabel('Department')
plt.ylabel('Number of Employees')
plt.tight_layout()
plt.savefig("department_distribution.png")

# Encode image in base64 for embedding
with open("department_distribution.png", "rb") as img_file:
    img_base64 = base64.b64encode(img_file.read()).decode()

# HTML with IT count embedded
html_content = f"""
<html>
<head><title>Department Distribution</title></head>
<body>
<h2>Department Distribution Histogram</h2>
<p><strong>{count_text}</strong></p>
<img src="data:image/png;base64,{img_base64}" alt="Department Distribution">
</body>
</html>
"""

# Save HTML
with open("department_distribution.html", "w") as f:
    f.write(html_content)
